# SOAメモ

<!-- TOC -->

- [SOAメモ](#soaメモ)
  - [概要](#概要)
  - [CloudWatch](#cloudwatch)
  - [CloudTrail](#cloudtrail)

<!-- /TOC -->

## 概要
- AWS認定試験の1つ、SysOpsアドミストレータアソシエイト(SOA)試験の学習メモ

## CloudWatch
- AWSのリソース使用状況の監視サービス。
- CPUやディスクIO、ネットワークラグなどの使用率についてリアルタイムでモニタリングしてくれる。
- 収集データは以下。
  - メトリクス
    - 数値化された使用状況
    - マネコンやCLIなどで確認可能。
    - **標準でCPUやディスクIOが取れる。**
    - OS内部データ(アプリケーションのメモリ使用量)などは別途**エージェント**をインストール。(**カスタムメトリクス**)
    - 「統計」「期間」「データポイント」によってアラームを設定することが可能。
    - アラームの状態は以下。
      - OK : 閾値より下
      - ALARM : 閾値より上
      - INSUFFICIENT_DATA : データ不足。判定不能状態。
      - **詳細モニタリング**を有効にしておく必要がある。
  - ログ
    - システムによって送信されるログの管理・検索などができる
    - LambdaやAPI Gatewayは標準でついている。EC2は別途エージェントをインストール
    - **メトリクスフィルター**機能でログをフィルタリングしてメトリクスを増やすことができる。
      - 例 : 「404」文字列が入っていたら、メトリクスを増やしてCloudWatchアラームに設定。
  - イベント
    - リソースの変更によって作業を行いたい時に利用。
    - 方式は以下2つ
      - **時間ベース** : 定時実行。cron・rate
        - 毎朝10時にAWS Batchジョブの実行
      - **システムイベント** : リソースのイベントによって実行。
        - 例 : インスタンス起動時にlambda実行

## CloudTrail
- AWSのアカウント作業ログを記録できるサービス
- 以下例。
  - 深夜に利用したユーザーの特定
  - セキュリティグループ変更したユーザーの特定
  - 不正アクセスの有無
- 連携できるサービスは以下。
  - s3
    - 証跡の管理・バックアップ
  - cloudwatch logs
    - メトリクスフィルターによりイベントの監視
  - cloudwatch event(event bridge)
    - 証跡イベントのルールを設定して、他サービスの自動実行