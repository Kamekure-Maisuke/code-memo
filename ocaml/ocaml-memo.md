# ocamlメモ

<!-- TOC -->

- [ocamlメモ](#ocamlメモ)
  - [概要](#概要)
  - [覚えておくこと](#覚えておくこと)
  - [記法](#記法)
    - [計算](#計算)
    - [変数宣言](#変数宣言)
    - [タプル](#タプル)
    - [リスト](#リスト)
    - [関数](#関数)
    - [再起関数](#再起関数)
    - [型指定](#型指定)
    - [型変換](#型変換)
    - [条件式](#条件式)
    - [パターンマッチ](#パターンマッチ)

<!-- /TOC -->

## 概要
- ML系の関数型言語。
- オブジェクト指向を取り入れたプログラミング言語
- 簡潔なコードが記述できる

## 覚えておくこと
- 関数型言語を利用する際に、覚えておくこと。
  - リスト利用の際には、`cons`と`car`、`cdr`という概念を覚えておく。
    - cons : リスト作成
    - car : リストの先頭部分
    - cdr : リストのcar以外の残りの部分。

## 記法

### 計算

```ocaml
4 + 4;;
4 - 2;;
3 * 3;;
6 / 4;;  (* 余りは出ない *)
```

### 変数宣言
- 型推論

```ocaml
(* NG *)
let x;;

(* OK *)
let x = 10;;
```

- 型指定の場合

```ocaml
let x : int = 78;;
let y : string = "Atom";;
let z : char = 'a';;
let b : bool = true;;
```

- ローカル変数

```ocaml
(* let ~~ in のように囲む。~~の値は式の略名のため、書き換えは不可能。*)
let add a b =
  let x = a + b in
  x + x * 2;;
```

### タプル
- 組みたいなもの。他言語でいうリストは次項

```ocaml
(* int型の配列 *)
let number = 4, 5, 6 ;;

(* 複数型の配列も可能 *)
let rdom = 4, 5, "やあ";;
```

### リスト
- 他言語でいうリスト(配列)みたいなもの。
- リストは全て同じ型。

```ocaml
(* 空リスト *)
[];;

(* int型のlist *)
[4; 6; 8];;

(* 先頭に要素を追加 *)
10 :: [3; 4; 5];;

(* 配列の結合 *)
[1; 2] @ [3; 4]
```

### 関数

```ocaml
(* 関数呼び出し
*  ※呼び出し時は、括弧や引数の間のカンマは不要。
*)
sum 8 8
average 8.0 6.0

(* 関数定義
 * returnは不要
*)
let sum a b = a + b;;   (* int *);;
let average a b = (a +. b) /. 2.0;;
```

### 再起関数
- 再起関数定義には、`rec`を付けないと利用できない。
- for等のloopは、関数型言語では再起関数で行う。

```ocaml
(* forの例 「引数の合計値」 *)
let rec sum a =
  if a <= 0 then 0
  else a + sum(a - 1);;

sum 10    (* 結果 : 55 *)
```

### 型指定
- ocamlで利用できる型一覧はこちら。

|型|内容|
|:---:|:---:|
|string|文字列|
|int|整数|
|float|浮動小数点数|
|bool|true or false|
|char|文字|
|unit|括弧のつくもの|

### 型変換
- ocamlでは、暗黙型変換は行われない

```ocaml
(* NG *)
2 + 3.0;;
2 +. 3.0;;

(* OK *)
(float_of_int 4) +. 3.0;;

(* こちらでもOK *)
float 4 +. 3.0;;
```

### 条件式

```ocaml
let max a b =
  if a > b then a else b;;

max 7 8;;
```

### パターンマッチ

```ocaml
(* 配列定義 *)
let numbers = [4; 5; 6];;

(* パターンマッチ関数定義 *)
let rec total l =
  match l with
    [] -> 0
    | a :: r -> a + (total r);;

(* 関数呼び出し *)
total numbers;;    (* 結果 : 15 *);;
```